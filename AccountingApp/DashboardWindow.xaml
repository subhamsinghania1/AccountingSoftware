<Window x:Class="AccountingApp.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Dashboard"
        WindowStartupLocation="CenterOwner"
        WindowState="Maximized"
        ResizeMode="CanMinimize">
    <DockPanel>
        <!-- Top bar with sign out button -->
        <DockPanel DockPanel.Dock="Top" Background="#007ACC" Height="40">
            <TextBlock Text="Accounting Dashboard" Foreground="White" FontSize="18" VerticalAlignment="Center" Margin="10,0,0,0" DockPanel.Dock="Left"/>
            <Button Content="Sign out" Width="80" Margin="0,0,10,0" DockPanel.Dock="Right" Click="SignOutButton_Click"/>
        </DockPanel>
        <TabControl>
            <TabItem Header="Home">
                <Grid Background="White">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="Welcome to the Accounting Dashboard" FontSize="24" HorizontalAlignment="Center"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                            <StackPanel Margin="10" HorizontalAlignment="Center">
                                <TextBlock Text="Total Vendors" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="VendorCountTextBlock" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="10" HorizontalAlignment="Center">
                                <TextBlock Text="Total Transactions" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="TransactionCountTextBlock" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="10" HorizontalAlignment="Center">
                                <TextBlock Text="Total Credit" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="SummaryCreditTextBlock" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="10" HorizontalAlignment="Center">
                                <TextBlock Text="Total Debit" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="SummaryDebitTextBlock" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="10" HorizontalAlignment="Center">
                                <TextBlock Text="Balance" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="SummaryBalanceTextBlock" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Header="Users" x:Name="UsersTab">
                <DockPanel>
                    <Button Content="Refresh Users" DockPanel.Dock="Top" Margin="10" Click="RefreshUsers_Click"/>
                    <DataGrid x:Name="UsersDataGrid" AutoGenerateColumns="False" Margin="10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Username" Binding="{Binding Username}" Width="150"/>
                            <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="100"/>
                            <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="80"/>
                            <DataGridTemplateColumn Header="Actions" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Revoke" Tag="{Binding Id}" Click="RevokeUser_Click" IsEnabled="{Binding IsActive}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            <TabItem Header="Vendors">
                <!-- Vendor management: add new vendors and list existing ones -->
                <DockPanel>
                    <!-- Top panel: inputs for adding a new vendor and refresh -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
                        <Button Content="Refresh" Click="RefreshVendors_Click" Margin="0,0,10,0"/>
                        <TextBox x:Name="VendorNameTextBox" Width="150" Margin="0,0,10,0"/>
                        <TextBox x:Name="VendorAddressTextBox" Width="150" Margin="0,0,10,0"/>
                        <TextBox x:Name="VendorPhoneTextBox" Width="120" Margin="0,0,10,0"/>
                        <Button Content="Add Vendor" Click="AddVendor_Click"/>
                    </StackPanel>
                    <!-- Vendor list -->
                    <DataGrid x:Name="VendorsDataGrid" AutoGenerateColumns="False" Margin="10" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="200"/>
                            <DataGridTextColumn Header="Phone" Binding="{Binding Phone}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            <TabItem Header="Transactions">
                <TabItem.Resources>
                    <SolidColorBrush x:Key="PrimaryBrush" Color="#FF3F51B5"/>
                    <SolidColorBrush x:Key="AccentBrush" Color="#FF009688"/>
                    <SolidColorBrush x:Key="DangerBrush" Color="#FFE74C3C"/>
                    <Style x:Key="ActionButtonStyle" TargetType="Button">
                        <Setter Property="FontFamily" Value="Segoe UI"/>
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Setter Property="Margin" Value="2"/>
                        <Setter Property="MinWidth" Value="80"/>
                        <Setter Property="Height" Value="32"/>
                        <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Style>
                    <Style x:Key="RefreshButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
                        <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                    </Style>
                    <Style x:Key="DeleteButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
                        <Setter Property="Background" Value="{StaticResource DangerBrush}"/>
                    </Style>
                    <Style x:Key="InputControlStyle" TargetType="Control">
                        <Setter Property="Height" Value="32"/>
                        <Setter Property="Margin" Value="0,5,0,0"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                    </Style>
                </TabItem.Resources>
                <!-- Transaction management: view, add and delete transactions -->
                <DockPanel>
                    <Button Content="Refresh" DockPanel.Dock="Top" Margin="10" Click="RefreshTransactions_Click" Style="{StaticResource RefreshButtonStyle}"/>
                    <DataGrid x:Name="TransactionsDataGrid" AutoGenerateColumns="False" Margin="10" DockPanel.Dock="Top" CanUserAddRows="False">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#FFD0E7FF"/>
                                        <Setter Property="Foreground" Value="Black"/>
                                    </Trigger>
                                    <MultiTrigger>
                                        <MultiTrigger.Conditions>
                                            <Condition Property="IsSelected" Value="True"/>
                                            <Condition Property="IsKeyboardFocusWithin" Value="False"/>
                                        </MultiTrigger.Conditions>
                                        <Setter Property="Background" Value="White"/>
                                        <Setter Property="Foreground" Value="Black"/>
                                    </MultiTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#FFD0E7FF"/>
                                        <Setter Property="Foreground" Value="Black"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.CellStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Vendor" Binding="{Binding VendorName}" Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=d}" Width="120" IsReadOnly="True"/>
                            <DataGridComboBoxColumn Header="Type" SelectedItemBinding="{Binding Type, UpdateSourceTrigger=PropertyChanged}" Width="80">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Credit</sys:String>
                                        <sys:String>Debit</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                            </DataGridComboBoxColumn>
                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Green"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Type}" Value="Debit">
                                                <Setter Property="Foreground" Value="Red"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description, UpdateSourceTrigger=PropertyChanged}" Width="200"/>
                            <DataGridTemplateColumn Header="Actions" Width="260" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="Edit" Margin="0,0,5,0" Click="EditTransaction_Click" Style="{StaticResource ActionButtonStyle}"/>
                                            <Button Content="Update" Margin="0,0,5,0" Tag="{Binding Id}" Click="UpdateTransaction_Click" Style="{StaticResource ActionButtonStyle}"/>
                                            <Button Content="Delete" Tag="{Binding Id}" Click="DeleteTransaction_Click" Style="{StaticResource DeleteButtonStyle}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border DockPanel.Dock="Bottom" Margin="10" Background="White" CornerRadius="6" Padding="10" BorderBrush="#DDDDDD" BorderThickness="1">
                        <StackPanel x:Name="AddTransactionPanel" Orientation="Vertical" KeyDown="AddTransactionPanel_KeyDown">
                            <StackPanel Orientation="Horizontal">
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Vendor"/>
                                    <ComboBox x:Name="AddTransactionVendorComboBox" Width="150" DisplayMemberPath="Name" SelectedValuePath="Id" ToolTip="Select vendor" Style="{StaticResource InputControlStyle}"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Date"/>
                                    <DatePicker x:Name="AddTransactionDatePicker" Width="120" ToolTip="Transaction date" Style="{StaticResource InputControlStyle}"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Type"/>
                                    <ComboBox x:Name="AddTransactionTypeComboBox" Width="100" ToolTip="Credit or debit" Style="{StaticResource InputControlStyle}">
                                        <ComboBoxItem Content="Credit"/>
                                        <ComboBoxItem Content="Debit"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Amount"/>
                                    <TextBox x:Name="AddTransactionAmountTextBox" Width="80" ToolTip="Amount" Style="{StaticResource InputControlStyle}"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Description"/>
                                    <TextBox x:Name="AddTransactionDescriptionTextBox" Width="150" ToolTip="Optional description" Style="{StaticResource InputControlStyle}"/>
                                </StackPanel>
                                <Button x:Name="AddTransactionButton" Content="Add Transaction" Margin="10,20,0,0" Click="AddTransaction_Click" Style="{StaticResource ActionButtonStyle}"/>
                            </StackPanel>
                            <TextBlock x:Name="AddTransactionErrorTextBlock" Foreground="Red" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                </DockPanel>
            </TabItem>
            <TabItem Header="Ledger">
                <TabItem.Resources>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="#007ACC"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Setter Property="Margin" Value="2"/>
                        <Setter Property="MinWidth" Value="90"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Height" Value="32"/>
                        <Setter Property="Cursor" Value="Hand"/>
                    </Style>
                    <Style TargetType="DataGrid">
                        <Setter Property="RowBackground" Value="White"/>
                        <Setter Property="AlternatingRowBackground" Value="#F3F3F3"/>
                        <Setter Property="GridLinesVisibility" Value="None"/>
                        <Setter Property="BorderBrush" Value="#DDDDDD"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="HeadersVisibility" Value="Column"/>
                        <Setter Property="RowHeight" Value="30"/>
                    </Style>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#007ACC"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="BorderThickness" Value="0"/>
                    </Style>
                </TabItem.Resources>
                <!-- Separate ledger view with vendor and date range filtering -->
                <DockPanel Margin="10" FontFamily="Segoe UI" FontSize="14">
                    <StackPanel Orientation="Vertical" DockPanel.Dock="Top" Margin="10">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="Vendor:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                            <ComboBox x:Name="LedgerVendorFilterComboBox" Width="150" DisplayMemberPath="Name" SelectedValuePath="Id"/>
                            <TextBlock Text="From:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                            <DatePicker x:Name="FromDatePicker" Width="120"/>
                            <TextBlock Text="To:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                            <DatePicker x:Name="ToDatePicker" Width="120"/>
                            <Button Content="Load Ledger" Click="LoadLedger_Click" Margin="10,0,0,0"/>
                        </StackPanel>
                        <TextBlock x:Name="LedgerVendorTextBlock" FontWeight="Bold" Margin="0,0,0,10"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="Opening Balance:" VerticalAlignment="Center"/>
                            <TextBox x:Name="OpeningBalanceTextBox" Width="80" Margin="5,0,10,0" TextChanged="OpeningBalanceTextBox_TextChanged"/>
                            <TextBlock Text="Total Credit:" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TotalCreditTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                            <TextBlock Text="Total Debit:" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TotalDebitTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                            <TextBlock Text="Closing Balance:" VerticalAlignment="Center"/>
                            <TextBlock x:Name="ClosingBalanceTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                            <TextBlock Text="Balance:" VerticalAlignment="Center"/>
                            <TextBlock x:Name="BalanceTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                        </StackPanel>
                    </StackPanel>
                    <DataGrid x:Name="LedgerDataGrid" AutoGenerateColumns="False" Margin="10" DockPanel.Dock="Top" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=d}" Width="120"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                            <DataGridTextColumn Header="Credit" Binding="{Binding CreditDisplay}" Width="100"/>
                            <DataGridTextColumn Header="Debit" Binding="{Binding DebitDisplay}" Width="100"/>
                            <DataGridTextColumn Header="Balance" Binding="{Binding BalanceDisplay}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            <TabItem Header="Roznamcha">
                <TabItem.Resources>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="#007ACC"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Setter Property="Margin" Value="2"/>
                        <Setter Property="MinWidth" Value="90"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Height" Value="32"/>
                        <Setter Property="Cursor" Value="Hand"/>
                    </Style>
                    <Style TargetType="DataGrid">
                        <Setter Property="RowBackground" Value="White"/>
                        <Setter Property="AlternatingRowBackground" Value="#F3F3F3"/>
                        <Setter Property="GridLinesVisibility" Value="None"/>
                        <Setter Property="BorderBrush" Value="#DDDDDD"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="HeadersVisibility" Value="Column"/>
                        <Setter Property="RowHeight" Value="30"/>
                    </Style>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#007ACC"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="BorderThickness" Value="0"/>
                    </Style>
                </TabItem.Resources>
                <DockPanel Margin="10" FontFamily="Segoe UI" FontSize="14">
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
                        <TextBlock Text="Date:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <DatePicker x:Name="RoznamchaDatePicker" Width="120"/>
                        <Button Content="Load" Margin="10,0,0,0" Click="LoadRoznamcha_Click"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10,0,0,10">
                        <TextBlock Text="Total Credit:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="RoznamchaCreditTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                        <TextBlock Text="Total Debit:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="RoznamchaDebitTextBlock" FontWeight="Bold" Margin="5,0,10,0"/>
                    </StackPanel>
                    <DataGrid x:Name="RoznamchaDataGrid" AutoGenerateColumns="False" Margin="10" DockPanel.Dock="Top" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Vendor" Binding="{Binding VendorName}" Width="150"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=d}" Width="120"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                            <DataGridTextColumn Header="Credit" Binding="{Binding CreditDisplay}" Width="100"/>
                            <DataGridTextColumn Header="Debit" Binding="{Binding DebitDisplay}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            <TabItem Header="Settings">
                <Grid Background="White">
                    <StackPanel Margin="20">
                        <TextBlock Text="Settings" FontSize="18"/>
                        <Button x:Name="KillButton" Content="Kill Switch" Width="200" Height="35" Margin="0,20,0,0" Click="KillButton_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
